generator client {
  provider   = "prisma-client-js"
  engineType = "library"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Session {
  id            String    @id
  shop          String
  state         String
  isOnline      Boolean   @default(false)
  scope         String?
  expires       DateTime?
  accessToken   String
  userId        BigInt?
  firstName     String?
  lastName      String?
  email         String?
  accountOwner  Boolean   @default(false)
  locale        String?
  collaborator  Boolean?  @default(false)
  emailVerified Boolean?  @default(false)

  @@index([expires])
  @@index([shop])
}

model rsl_staff {
  id   Int     @id @default(autoincrement())
  name String? @db.VarChar(60)
  role String? @db.VarChar(60)
  gid  String? @db.VarChar(60)
}

model tbl_logisticsUser {
  id                             Int                              @id @default(autoincrement())
  email                          String                           @unique
  displayName                    String?
  userType                       String
  isActive                       Boolean                          @default(true)
  companyID                      String
  password                       String?
  createdAt                      DateTime                         @default(now())
  updatedAt                      DateTime
  tlkp_company                   tlkp_company                     @relation(fields: [companyID], references: [shortName])
  tbl_purchaseOrderNotes         tbl_purchaseOrderNotes[]
  tbljn_logisticsUser_permission tbljn_logisticsUser_permission[]
}

model tbl_purchaseOrder {
  id                             Int                              @id @default(autoincrement())
  shortName                      String                           @unique
  purchaseOrderGID               String                           @unique
  purchaseOrderPdfUrl            String?
  createdAt                      DateTime                         @default(now())
  updatedAt                      DateTime
  statusShortName                String?
  tlkp_purchaseOrderStatus       tlkp_purchaseOrderStatus?        @relation(fields: [statusShortName], references: [shortName])
  tbl_purchaseOrderNotes         tbl_purchaseOrderNotes[]
  tbljn_purchaseOrder_company    tbljn_purchaseOrder_company[]
  tbljn_purchaseOrder_rslProduct tbljn_purchaseOrder_rslProduct[]
  tbljn_shipment_purchaseOrder   tbljn_shipment_purchaseOrder[]

  @@index([statusShortName])
}

model tbl_purchaseOrderNotes {
  id                Int                @id @default(autoincrement())
  purchaseOrderGID  String
  userId            Int?
  createdAt         DateTime           @default(now())
  content           String
  pdfUrl            String?
  pdfFileName       String?            @db.VarChar(255)
  eventType         String?            @db.VarChar(30)
  tbl_purchaseOrder tbl_purchaseOrder  @relation(fields: [purchaseOrderGID], references: [purchaseOrderGID], onDelete: Cascade)
  tbl_logisticsUser tbl_logisticsUser? @relation(fields: [userId], references: [id])

  @@index([createdAt])
  @@index([purchaseOrderGID])
  @@index([userId])
}

model tbl_shipment {
  id                           Int                            @id @default(autoincrement())
  companyId                    String
  companyName                  String
  containerNumber              String                         @unique
  containerSize                String?
  portOfOrigin                 String?
  destinationPort              String?
  etaDate                      DateTime?
  cargoReadyDate               DateTime?
  estimatedDeliveryToOrigin    DateTime?
  supplierPi                   String?
  quantity                     BigInt?
  bookingNumber                String?
  status                       String?
  notes                        String?
  createdAt                    DateTime                       @default(now())
  updatedAt                    DateTime
  bookingAgent                 String?
  deliveryAddress              String?
  vesselName                   String?
  tlkp_bookingAgent            tlkp_bookingAgent?             @relation(fields: [bookingAgent], references: [shortName])
  tlkp_company                 tlkp_company                   @relation(fields: [companyId], references: [shortName])
  tlkp_container               tlkp_container?                @relation(fields: [containerSize], references: [shortName])
  tlkp_deliveryAddress         tlkp_deliveryAddress?          @relation(fields: [deliveryAddress], references: [shortName])
  tlkp_destinationPort         tlkp_destinationPort?          @relation(fields: [destinationPort], references: [shortName])
  tlkp_originPort              tlkp_originPort?               @relation(fields: [portOfOrigin], references: [shortName])
  tbljn_shipment_purchaseOrder tbljn_shipment_purchaseOrder[]
}

model tbljn_logisticsUser_permission {
  id                Int               @id @default(autoincrement())
  logisticsUserID   Int
  permissionID      Int
  tbl_logisticsUser tbl_logisticsUser @relation(fields: [logisticsUserID], references: [id])
  tlkp_permission   tlkp_permission   @relation(fields: [permissionID], references: [id])

  @@index([logisticsUserID])
  @@index([permissionID])
}

model tbljn_purchaseOrder_company {
  id                Int               @id @default(autoincrement())
  purchaseOrderGID  String
  companyID         String
  tlkp_company      tlkp_company      @relation(fields: [companyID], references: [shortName], onDelete: Cascade)
  tbl_purchaseOrder tbl_purchaseOrder @relation(fields: [purchaseOrderGID], references: [purchaseOrderGID], onDelete: Cascade)

  @@unique([purchaseOrderGID, companyID])
  @@index([companyID])
  @@index([purchaseOrderGID])
}

model tbljn_purchaseOrder_rslProduct {
  id                Int               @id @default(autoincrement())
  purchaseOrderGID  String
  rslProductID      String
  quantity          Int               @default(0)
  tbl_purchaseOrder tbl_purchaseOrder @relation(fields: [purchaseOrderGID], references: [purchaseOrderGID], onDelete: Cascade)
  tlkp_rslProduct   tlkp_rslProduct   @relation(fields: [rslProductID], references: [shortName], onDelete: Cascade)

  @@unique([purchaseOrderGID, rslProductID], map: "tbljn_purchaseOrder_rslProduct_purchaseOrderGID_rslProductID_ke")
  @@index([purchaseOrderGID])
  @@index([rslProductID])
}

model tbljn_shipment_purchaseOrder {
  id                Int               @id @default(autoincrement())
  shipmentID        String
  purchaseOrderGID  String
  tbl_purchaseOrder tbl_purchaseOrder @relation(fields: [purchaseOrderGID], references: [purchaseOrderGID])
  tbl_shipment      tbl_shipment      @relation(fields: [shipmentID], references: [containerNumber])

  @@index([purchaseOrderGID])
  @@index([shipmentID])
}

model tlkp_bookingAgent {
  id           Int            @id @default(autoincrement())
  shortName    String         @unique
  displayName  String?
  tbl_shipment tbl_shipment[]
}

model tlkp_company {
  id                          Int                           @id(map: "tbl_company_pkey") @default(autoincrement())
  shortName                   String                        @unique(map: "tbl_company_shortName_key")
  displayName                 String?
  address1                    String?
  address2                    String?
  city                        String?
  province                    String?
  postalCode                  String?
  country                     String?
  primaryContact              String?
  primaryPhone                String?
  primaryEmail                String?
  supplierCurrency            String?
  tbl_logisticsUser           tbl_logisticsUser[]
  tbl_shipment                tbl_shipment[]
  tbljn_purchaseOrder_company tbljn_purchaseOrder_company[]
}

model tlkp_container {
  id           Int            @id @default(autoincrement())
  shortName    String         @unique
  displayName  String
  tbl_shipment tbl_shipment[]
}

model tlkp_deliveryAddress {
  id           Int            @id @default(autoincrement())
  shortName    String         @unique
  displayName  String?
  tbl_shipment tbl_shipment[]
}

model tlkp_destinationPort {
  id           Int            @id @default(autoincrement())
  shortName    String         @unique
  displayName  String?
  tbl_shipment tbl_shipment[]
}

model tlkp_originPort {
  id           Int            @id @default(autoincrement())
  shortName    String         @unique
  displayName  String?
  tbl_shipment tbl_shipment[]
}

model tlkp_permission {
  id                             Int                              @id @default(autoincrement())
  shortName                      String                           @unique
  displayName                    String
  tbljn_logisticsUser_permission tbljn_logisticsUser_permission[]
}

model tlkp_purchaseOrderStatus {
  id                Int                 @id @default(autoincrement())
  shortName         String              @unique
  displayName       String
  tbl_purchaseOrder tbl_purchaseOrder[]
}

model tlkp_rslProduct {
  id                             Int                              @id(map: "tlkp_rslproduct_pkey") @default(autoincrement())
  shortName                      String                           @unique(map: "tlkp_rslproduct_shortname_key")
  displayName                    String
  SKU                            String                           @unique(map: "tlkp_rslproduct_sku_key")
  tbljn_purchaseOrder_rslProduct tbljn_purchaseOrder_rslProduct[]
}
